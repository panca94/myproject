<%- include('../partials/header') %>

<h1>Edit Pelanggan</h1>

<form action="/customers/edit/<%= customer.id %>?_method=PUT" method="POST">
    <div class="mb-3">
        <label for="name" class="form-label">Nama Pelanggan</label>
        <input type="text" class="form-control" id="name" name="name" value="<%= customer.name %>" required>
    </div>
    
    <% if (user.role === 'admin' || user.role === 'manager') { %>
        <div class="mb-3">
            <label for="userId" class="form-label">Ditangani oleh (Sales)</label>
            <select class="form-select" id="userId" name="userId" required>
                <% salesUsers.forEach(sales => { %>
                    <option value="<%= sales.id %>" <%= (customer.userId === sales.id) ? 'selected' : '' %>><%= sales.username %></option>
                <% }) %>
            </select>
        </div>
    <% } else { %>
        <div class="mb-3">
            <label for="userId" class="form-label">Ditangani oleh (Sales)</label>
            <input type="text" class="form-control" value="<%= customer.sales.username %>" readonly>
            <input type="hidden" name="userId" value="<%= customer.userId %>">
        </div>
    <% } %>

    <button type="submit" class="btn btn-primary">Update</button>
    <a href="/customers" class="btn btn-secondary">Batal</a>
</form>

<%- include('../partials/footer') %>